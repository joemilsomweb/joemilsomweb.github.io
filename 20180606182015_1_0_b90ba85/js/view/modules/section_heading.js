define(["jquery","underscore","backbone","model/loader_collection","view/common/base_view","config","three","text!shaders/section_heading/section_heading_vert.glsl","text!shaders/section_heading/section_heading_frag.glsl","util/anim_frame","TweenMax"],function(e,t,i,s,a,n,r,u,o,h,l){"use strict";s.add({id:"about_heading",src:"20180606182015_1_0_b90ba85/img/about/about_heading.png"});var m=a.extend({currentInd:0,initialize:function(e){this.headingId=e.headingId,this.setupScene(),this.addEvents(),this.currentFrame=0,this.noiseInc=.02},setupScene:function(){this.renderer=new r.WebGLRenderer({canvas:this.el,alpha:!0}),this.scene=new r.Scene,this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1),this.geometry=new r.PlaneBufferGeometry(2,2),this.engTextImg=s.getResult(this.headingId);var e=s.getResult("patternBg");this.renderer.setSize(this.engTextImg.naturalWidth,this.engTextImg.naturalHeight),this.el.style.width="",this.el.style.height="",this.texEng=new r.Texture(this.engTextImg),this.texEng.needsUpdate=!0,this.texEng.wrapS=r.RepeatWrapping,this.texEng.wrapT=r.RepeatWrapping,this.patternBg=new r.Texture(e),this.patternBg.needsUpdate=!0,this.patternBg.wrapS=r.RepeatWrapping,this.patternBg.wrapT=r.RepeatWrapping,this.material=new r.ShaderMaterial({vertexShader:u,fragmentShader:o,uniforms:{tex:{type:"t",value:this.texEng},tex_2:{type:"t",value:this.patternBg},noiseMultiplier:{type:"f",value:0},redMultiplier:{type:"f",value:1},greenMultiplier:{type:"f",value:1},blueMultiplier:{type:"f",value:1},mouseOver:{type:"i",value:0},mixValue:{type:"f",value:0},mousePos:{type:"v2",value:new r.Vector2(0,0)},resolution:{type:"v2",value:new r.Vector2(this.engTextImg.naturalWidth,this.engTextImg.naturalHeight)},mouseOverScale:{type:"f",value:0}},transparent:!0}),this.mesh=new r.Mesh(this.geometry,this.material),this.scene.add(this.mesh),this.addMouseEvents()},addMouseEvents:function(){this.$el.on("mousemove",t.bind(this.onMouseMove,this)),this.$el.on("mouseover touchstart",t.bind(this.onMouseOver,this)),this.$el.on("mouseout",t.bind(this.onMouseOut,this))},onMouseOver:function(e){this.material.uniforms.mouseOver.value=1,l.killTweensOf(this.material.uniforms.mouseOverScale,this,this.material.uniforms.mixValue),l.to(this.material.uniforms.mixValue,2.5,{value:1,ease:"Circ.easeOut"})},onMouseMove:function(e){var t=this.$el.innerWidth(),i=this.$el.innerHeight(),s=this.engTextImg.naturalWidth/t;this.material.uniforms.mousePos.value.x=e.offsetX*s,this.material.uniforms.mousePos.value.y=e.offsetY*s;var a=Math.abs(e.offsetY-i/2)/i*2;this.noiseInc=.025+.035*a,this.material.uniforms.mouseOverScale.value=a},onMouseOut:function(e){this.material.uniforms.mouseOver.value=0,l.killTweensOf(this,this.material.uniforms.mixValue,this.material.uniforms.mouseOverScale),l.to(this.material.uniforms.mixValue,1,{value:0,ease:"Circ.easeOut"}),l.to(this,1,{noiseInc:.025,ease:"Circ.easeOut"}),l.to(this.material.uniforms.mouseOverScale,.6,{value:0,ease:"Elastic.easeOut"})},addEvents:function(){h.on("anim_frame",this.onAnimFrame,this)},onAnimFrame:function(){this.renderer.render(this.scene,this.camera),this.material.uniforms.noiseMultiplier.value+=this.noiseInc},destroy:function(){a.prototype.destroy.apply(this,arguments)}});return m});