define(["jquery","underscore","view/common/base_view","config","route/router","model/app_model","model/loader_collection","util/anim_frame","TweenMax"],function(t,i,e,s,o,n,a,h,r){"use strict";return e.extend({size:400,imageLoaded:!1,scale:0,initialize:function(){this.loaderCanvas=this.$(".js-loaderCanvas")[0],this.loaderCanvas.width=this.size,this.loaderCanvas.height=this.size,this.context=this.loaderCanvas.getContext("2d"),h.on("anim_frame",this.onAnimFrame,this),this.img=new Image,this.img.src=this.imagePath,this.img.onload=i.bind(this.onLoad,this),this.currentFrame=0},getRndColor:function(){var t=255*Math.random()|0,i=255*Math.random()|0,e=255*Math.random()|0;return"rgb("+t+","+i+","+e+")"},onLoad:function(){this.imageLoaded=!0},show:function(){a.on("progress",this.onLoadProgress,this)},onAnimFrame:function(){this.currentFrame++,this.imageLoaded&&(this.currentFrame%2===0&&(this.context.fillStyle=this.getRndColor()),this.context.globalCompositeOperation="source-over",this.context.fillRect(0,0,this.size,this.size),this.context.globalCompositeOperation="destination-in",this.context.drawImage(this.img,0,0,this.size,this.size),this.context.globalCompositeOperation="destination-out",this.context.save(),this.context.translate(this.size/2,this.size/2,0),this.context.scale(this.scale,this.scale),this.context.fillRect(-this.size/2,-this.size/2,this.size,this.size),this.context.restore())},onHideComplete:function(){this.onAnimOutComplete()},onAnimOutComplete:function(){this.trigger("hideComplete"),h.off(null,null,this)}})});